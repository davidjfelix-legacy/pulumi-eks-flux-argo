
# Default recipe, run on `just`
_default:
  just --list

# Use Pulumi to deploy. Pass -y to automatically deploy
deploy *ARGS:
  pulumi up --stack main {{ARGS}}
  mkdir -p out/.kube
  pulumi stack output kubeconfig > out/.kube/config

# Pass CI specific args to deploy
deploy-ci:
  @just deploy -y

# Use Pulumi to destroy. Pass -y to automatically deploy
undeploy *ARGS:
  pulumi down --stack main {{ARGS}}

undeploy-ci:
  @just undeploy -y
